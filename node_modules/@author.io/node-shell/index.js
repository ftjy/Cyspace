// @author.io/shell v1.8.2
// Copyright (c) 2020 Corey Butler
// Released under the MIT License.
function e(e,t){var s=t.get(e);if(!s)throw new TypeError("attempted to get private field on non-instance");return s.get?s.get.call(e):s.value}function t(e,t,s){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,s);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=s}return s}var s=new WeakMap,i=new WeakMap,a=new WeakMap,r=new WeakMap,n=new WeakMap,l=new WeakMap,h=new WeakMap,o=new WeakMap,u=new WeakMap,p=new WeakMap,c=new WeakMap,f=new WeakMap,d=new WeakMap,g=new WeakMap;class m{constructor(m={}){if(s.set(this,{writable:!0,value:void 0}),i.set(this,{writable:!0,value:void 0}),a.set(this,{writable:!0,value:void 0}),r.set(this,{writable:!0,value:null}),n.set(this,{writable:!0,value:new Set}),l.set(this,{writable:!0,value:!1}),h.set(this,{writable:!0,value:String}),o.set(this,{writable:!0,value:!1}),u.set(this,{writable:!0,value:!0}),p.set(this,{writable:!0,value:new Set}),c.set(this,{writable:!0,value:null}),f.set(this,{writable:!0,value:new Set}),d.set(this,{writable:!0,value:!1}),g.set(this,{writable:!0,value:null}),"string"==typeof m&&(m={name:m}),!m.name)throw new Error("Flag name is required.");if(t(this,i,m.name),t(this,s,m.name.replace(/^-+/gi,"").trim()),m.hasOwnProperty("description")&&t(this,a,m.description),m.hasOwnProperty("default")&&t(this,r,m.default),m.hasOwnProperty("alias")&&this.createAlias(m.alias),m.hasOwnProperty("aliases")&&this.createAlias(m.aliases),m.hasOwnProperty("required")&&t(this,l,m.required),m.hasOwnProperty("type")&&(this.type=m.type),m.hasOwnProperty("allowMultipleValues")&&t(this,o,m.allowMultipleValues),m.hasOwnProperty("strictTypes")&&t(this,u,m.strictTypes),m.hasOwnProperty("options")&&(this.options=m.options),m.hasOwnProperty("validate")){if(!(m.validate instanceof RegExp||"function"==typeof m.validate))throw new Error(`The "validate" configuration attribute for ${e(this,i)} is invalid. Only RegExp and functions are supported (received ${typeof m.validate})`);t(this,g,m.validate)}}get inputName(){return e(this,i)}get recognized(){return e(this,d)}set recognized(e){t(this,d,e)}get required(){return e(this,l)}set required(e){t(this,l,e)}get valid(){const i=this.value;if(t(this,f,new Set),e(this,l)&&(e(this,o)?0===this.value.length:null===this.value))return t(this,f,new Set([`"${e(this,s)}" is required.`])),!1;if(e(this,p).size>0)if(e(this,o)){const t=i.filter(t=>!e(this,p).has(t));if(t.length>0)return t.forEach(t=>e(this,f).add(`"${t}" is invalid. Expected one of: ${Array.from(e(this,p)).join(", ")}`)),!1}else if(!e(this,p).has(i))return e(this,f).add(`"${i}" is invalid. Expected one of: ${Array.from(e(this,p)).join(", ")}`),!1;if(e(this,u)){const t=this.type;if("any"!==t&&"*"!==t&&this.recognized)if(e(this,o)){const s=i.filter(e=>typeof e!==t);if(s.length>0)return s.forEach(s=>e(this,f).add(`"${this.name}" (${s}) should be a ${t}, not ${typeof s}.`)),!1}else if(null!==i&&typeof i!==t)return e(this,f).add(`"${this.name}" should be a ${t}, not ${typeof i}.`),!1}if(null!==e(this,g))if("function"==typeof e(this,g)){if(!e(this,g).call(this,i))return e(this,f).add(`"${i}" is invalid (failed custom validation).`),!1}else{if("string"!=typeof i&&e(this,g)instanceof RegExp)return e(this,f).add(`"${i}" is invalid (failed custom validation).`),!1;if(!e(this,g).test(i))return e(this,f).add(`"${i}" is invalid (failed custom validation).`),!1}return!0}get violations(){return this.valid?[]:Array.from(e(this,f))}get type(){return e(this,h).name.split(/\s+/)[0].toLowerCase()}set type(e){if("string"==typeof e)switch(e.trim().toLowerCase()){case"number":case"integer":case"float":case"double":t(this,h,Number);break;case"bigint":t(this,h,BigInt);break;case"boolean":t(this,h,Boolean);break;default:t(this,h,String)}else t(this,h,e)}get strictTypes(){return e(this,u)}set strictTypes(e){if("boolean"!=typeof e)throw new Error("strictTypes must be a boolean value.");t(this,u,e)}get name(){return e(this,s)}set name(e){t(this,s,e.trim())}get description(){return e(this,s)}set description(e){t(this,a,e.trim())}get value(){if(e(this,o)&&null===e(this,c)){if(null===e(this,r))return[];if(!Array.isArray(e(this,r)))return[e(this,r)]}return e(this,c)||e(this,r)}set value(s){if(e(this,o)){if(Array.isArray(s))return void t(this,c,s);t(this,c,e(this,c)||[]),e(this,c).push(s)}else t(this,c,s)}get options(){return Array.from(e(this,p))}set options(e){"string"==typeof e&&(e=e.split(",").map(e=>e.trim())),t(this,p,new Set(e))}get aliases(){return Array.from(e(this,n))}get multipleValuesAllowed(){return e(this,o)}hasAlias(t){return e(this,n).has(t)}createAlias(){for(let t of arguments)if(t instanceof Set&&(t=Array.from(t)),Array.isArray(t))this.createAlias(...t);else{if("string"!=typeof t)throw new Error(`Cannot create an alias for a ${typeof t} element. Please specify a string instead.`);e(this,n).add(t.replace(/^-+/gi,""))}}allowMultipleValues(){e(this,o)||(null!==e(this,c)&&t(this,c,[e(this,c)]),null!==e(this,r)&&t(this,r,[e(this,r)]),t(this,o,!0))}preventMultipleValues(){e(this,o)&&(null!==e(this,c)&&t(this,c,e(this,c).pop()),null!==e(this,r)&&t(this,r,e(this,r).pop()),t(this,o,!1))}}const w=/\s*(?:((?:(?:"(?:\\.|[^"])*")|(?:'[^']*')|(?:\\.)|\S)+)\s*)/gi;var y=new WeakMap,b=new WeakMap,v=new WeakMap,O=new WeakMap,M=new WeakMap,A=new WeakMap,E=new WeakMap,k=new WeakMap,W=new WeakMap,P=new WeakMap;class _{constructor(e=null,t=null){y.set(this,{writable:!0,value:[]}),b.set(this,{writable:!0,value:new Map}),v.set(this,{writable:!0,value:new Map}),O.set(this,{writable:!0,value:!0}),M.set(this,{writable:!0,value:new Set}),A.set(this,{writable:!0,value:!1}),E.set(this,{writable:!0,value:new Set}),k.set(this,{writable:!0,value:null}),W.set(this,{writable:!0,value:e=>e.replace(/^\-+/,"").trim().toLowerCase()}),P.set(this,{writable:!0,value:e=>this.getFlag(e)||this.addFlag(e)}),null===e||"object"!=typeof e||Array.isArray(e)||(t=e,e=null),null!==t&&this.configure(t),globalThis.hasOwnProperty("argv")?this.parse(process.argv.slice(2)):null!==e&&this.parse(e)}get length(){return e(this,y).length}get valid(){return t(this,k,!0),t(this,M,new Set),e(this,b).forEach((s,i)=>{e(this,E).has(i)||(s.strictTypes=!e(this,A),s.valid||(t(this,k,!1),t(this,M,new Set([...e(this,M),...s.violations]))),e(this,O)||s.recognized||(t(this,k,!1),e(this,M).add(`"${i}" is unrecognized.`)))}),!e(this,O)&&e(this,v).size>0&&(t(this,k,!1),e(this,v).forEach(t=>e(this,M).add(`"${t.name}" is unrecognized.`))),e(this,k)}get violations(){return t(this,k,e(this,k)||this.valid),Array.from(e(this,M))}get unrecognizedFlags(){let t=new Set;return e(this,b).forEach((s,i)=>{e(this,E).has(i)||s.recognized||t.add(s.name)}),e(this,v).forEach(e=>t.add(e.name)),Array.from(t)}get recognizedFlags(){let t=new Set;return e(this,b).forEach((s,i)=>{e(this,E).has(i)||s.recognized&&t.add(i)}),Array.from(t)}get flags(){return Array.from(e(this,b).keys()).concat(Array.from(e(this,v).keys()))}get data(){let t={},s={};return e(this,b).forEach((i,a)=>{e(this,E).has(a)||(t[i.name]=i.value,Object.defineProperty(s,i.name,{enumerable:!0,get:()=>i}))}),e(this,v).forEach((e,i)=>{let a=e.name,r=0;for(;t.hasOwnProperty(a);)r++,a=`${a}${r}`;t[a]=!0,Object.defineProperty(s,a,{enumerable:!0,get:()=>e})}),Object.defineProperty(t,"flagSource",{enumerable:!1,writable:!1,configurable:!1,value:s}),t}configure(e={}){for(let[t,s]of Object.entries(e))s.name=t,this.addFlag(s).recognized=!0}parse(s){if(!s)return;t(this,y,Array.isArray(s)?s:s.match(w).map(e=>{const t=(e=e.trim()).match(/((^"(.*)"$)|(^'(.*)'$))/i);return null!==t?t[3]:e}));let i=!1,a=[];const r=new Set(["true","false"]);e(this,y).forEach((t,s,n)=>{if(!i||t.startsWith("-"))if(t.startsWith("-")){i=!0;const a=e(this,P).call(this,t);if(void 0!==e(this,y)[s+1])if(e(this,y)[s+1].startsWith("-"))a.value=!0;else{let t=e(this,y)[s+1],n=!1;"boolean"===a.type&&(n=!0,void 0!==e(this,y)[s+1]&&(r.has(t.toLowerCase())?"true"===t.trim().toLowerCase()?a.value=!0:"false"===t.trim().toLowerCase()&&(a.value=!1):(i=!1,a.value=!0))),n||(a.value=t)}else a.value=!0}else if(this.exists(t)){if(!t.startsWith("-")){let s=new m(e(this,W).call(this,t));s.strictTypes=!e(this,A),e(this,v).set(e(this,W).call(this,t),s)}}else this.addFlag(t).value=!0;else a.push([t,n[s-1]]),i=!1}),a.forEach(e=>{const t=e[0],s=e[1];if(null==s)this.addFlag(t);else{let e=this.getFlag(s);e.hasOwnProperty("aliasOf")&&(e=e.aliasOf,e.value=t),e&&(e.recognized||s.startsWith("-"))||this.addFlag(t)}}),e(this,b).forEach((t,s)=>{e(this,E).has(s)&&(void 0===t.value||t.aliasOf.multipleValuesAllowed||(t.aliasOf.value=t.value))})}getFlag(t){return e(this,b).get(e(this,W).call(this,t))||e(this,v).get(e(this,W).call(this,t))}addFlag(t){t="object"==typeof t?t:{name:t};const s=e(this,W).call(this,t.name);if(e(this,b).has(s))throw new Error(`"${t.name}" flag already exists.`);const i=new m(t);return i.strictTypes=!e(this,A),e(this,b).set(s,i),i.aliases.length>0&&i.aliases.forEach(t=>{e(this,b).set(e(this,W).call(this,t),{aliasOf:e(this,b).get(s)}),e(this,E).add(e(this,W).call(this,t))}),e(this,b).get(s)}exists(t){return e(this,b).has(e(this,W).call(this,t))||e(this,v).has(e(this,W).call(this,t))}typeof(t){return this.exists(t)?this.getFlag(t).type:e(this,v).has(e(this,W).call(this,t))?"boolean":"undefined"}value(t=null){return this.exists(t)?this.getFlag(t).value:!!e(this,v).has(e(this,W).call(this,t))||void 0}getFlagAliases(e){return this.exists(e)?new Set(this.getFlag(e).aliases):new Set}require(){Array.from(arguments).map(t=>{if(!e(this,E).has(t)){const s=e(this,P).call(this,t);s.required=!0,s.recognized=!0}})}recognize(){Array.from(arguments).map(e=>(this.getFlag(e)||this.addFlag(e)).recognized=!0)}disallowUnrecognized(){t(this,O,!1)}allowUnrecognized(){t(this,O,!0)}ignoreDataTypes(){t(this,A,!1),e(this,b).forEach((t,s)=>{t.strictTypes=!1,e(this,b).set(s,t)})}enforceDataTypes(){t(this,A,!0),e(this,b).forEach((t,s)=>{t.strictTypes=!0,e(this,b).set(s,t)})}defaults(t={}){for(let[s,i]of Object.entries(t)){const t=e(this,P).call(this,s);t.default=i,t.recognized=!0}}alias(t={}){for(let[s,i]of Object.entries(t)){const t=e(this,P).call(this,s);if(e(this,E).has(i)&&s.toLowerCase()!==t.name.toLowerCase())throw new Error(`The "${i}" alias is already associated to the "${this.getFlag(i).name}" flag.`);t.hasAlias(i)||t.createAlias.apply(t,i),t.recognized=!0}}allowMultipleValues(){for(const t of arguments)e(this,P).call(this,t).allowMultipleValues()}preventMultipleValues(){for(const t of arguments)e(this,P).call(this,t).preventMultipleValues()}setOptions(){if(arguments.length<2)throw new Error("setOptions method requires the flag name and at least one value (i.e. minimum 2 arguments).");const t=Array.from(arguments),s=e(this,P).call(this,t.shift());s.recognized=!0,s.options=t}describe(t,s){e(this,P).call(this,t).description=s}description(e){const t=this.getFlag(e);return t?t.description:"undefined"}enforceRules(){if(t(this,k,this.valid),!e(this,k)){if(globalThis.hasOwnProperty("process"))return globalThis.process.exit(1);throw new Error("Process exited with error.")}return e(this,k)}}new _;class S{constructor(){Object.defineProperties(this,{_data:{enumerable:!1,configurable:!1,value:[]},go:{enumerable:!1,configurable:!1,writable:!0,value:(...e)=>{e.pop().apply(this,e)}}})}get size(){return this._data.length}get data(){return this._data}use(e){const t=e.toString();t.indexOf("[native code]")<0&&this._data.push(t),this.go=(t=>(...s)=>{let i=s.pop();t(...s,()=>{e.apply(this,[...s,i.bind(null,...s)])})})(this.go)}run(){const e=Array.from(arguments);0!==e.length&&"function"==typeof e[e.length-1]||e.push(()=>{}),this.go(...e)}}const j=(e,t,s)=>{if(t<1)throw new Error("Width must be at least 1.");let i=[e.substring(0,t)];if((e=e.substring(t)).length>t){const a=e.match(s)||[];let r=e.substring(a.join("").length);if(a.length>0&&(i=i.concat(a)),r.length>0&&r.length>t)if(x.test(r))i=i.concat(j(r,t));else{let e=0;for(console.log(r.length,t);r.length>0&&e<20;)e++,r.length<=t?(i.push(r),r=""):(i.push(r.substring(0,t)),r=r.substring(t),console.log(">>>",r,i))}else r>0&&i.push(r)}return i},$=(e,t,s="right",i=" ")=>{if(e.length>=t)return e;switch(s){case"center":return e.padStart(Math.floor(e.length/2),i).padEnd(t,i);case"left":return e.padStart(t,i);default:return e.padEnd(t,i)}},z=(e=0,t=" ")=>t.repeat(e),T=e=>new RegExp(`(.{0,${e}})[\\s\\n\\t(\\.\\s)]`,"g"),x=T(2e3);var C=new WeakMap,F=new WeakMap,H=new WeakMap,R=new WeakMap,q=new WeakMap,D=new WeakMap,L=new WeakMap,V=new WeakMap,I=new WeakMap,N=new WeakMap,U=new WeakMap,B=new WeakMap,G=new WeakMap,Z=new WeakMap,J=new WeakMap,K=new WeakMap,Q=new WeakMap,X=new WeakMap;class Y{constructor(s=[],i=[],a=[],r=80,n=[0,0,0,0]){C.set(this,{writable:!0,value:void 0}),F.set(this,{writable:!0,value:new Map}),H.set(this,{writable:!0,value:[]}),R.set(this,{writable:!0,value:[]}),q.set(this,{writable:!0,value:void 0}),D.set(this,{writable:!0,value:2}),L.set(this,{writable:!0,value:1/0}),V.set(this,{writable:!0,value:0}),I.set(this,{writable:!0,value:void 0}),N.set(this,{writable:!0,value:[]}),U.set(this,{writable:!0,value:[]}),B.set(this,{writable:!0,value:[]}),G.set(this,{writable:!0,value:new Map}),Z.set(this,{writable:!0,value:" "}),J.set(this,{writable:!0,value:t=>{t=t.replace(/\t/g,z(e(this,D)));const s=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))","\\x1B[[(?);]{0,2}(;?\\d)*.","\\033(\\[(\\[H\\033\\[2J|\\d+;\\d+H|\\d+(;\\d+;\\d+(;\\d+;\\d+)?m|[mABCDFGd])|[HJK]|1K)|[78]|\\d*[PMX]|\\(B\\033\\[m)"].join("|");return t.replace(new RegExp(s,"g"),"")}}),K.set(this,{writable:!0,value:void 0}),Q.set(this,{writable:!0,value:!1}),X.set(this,{writable:!0,value:()=>{if(e(this,Q))return;t(this,Q,!0);let s=e(this,C).reduce((e,t)=>t.length>e?t.length:e,0);const i=new Array(s).fill(0).map((e,t)=>t);t(this,B,i);for(let t of e(this,C))if(t.forEach((t,s)=>{t=e(this,J).call(this,t),i.indexOf(s)>=0&&null!=t&&"string"==typeof t&&t.trim().length>0&&i.splice(i.indexOf(s),1)}),0===i.length)break;if(s-=i.length,0===s)return;i.length>0&&(t(this,U,i),t(this,C,e(this,C).map(e=>e.filter((e,t)=>i.indexOf(t)<0)))),0===e(this,H).length&&(e(this,R).length>0?t(this,H,new Array(e(this,R).length).fill("l")):t(this,H,new Array(e(this,C)[0].length-i.length).fill("l")));for(let t=e(this,H).length;t<s;t++)e(this,H).push("l");let a=-1,r=0;if(new Set(0===e(this,R).length?new Array(e(this,H).length).map((e,t)=>t):new Array(e(this,H).length-e(this,R).length).map((e,t)=>t)),e(this,K)||0===e(this,R).length)a=Math.floor(e(this,q)/s),r=e(this,q)%s;else{t(this,R,e(this,R).filter((e,t,s)=>i.indexOf(t)<0)),e(this,R).forEach((t,s,i)=>{if("string"==typeof t&&"%"===t.substring(t.length-1)){const a=parseFloat(t.replace(/[^0-9]+/g,""))/100;i[s]=Math.ceil(e(this,q)*a)}});const n=e(this,q)-e(this,R).reduce((e,t)=>e+t,0);a=Math.floor(n/(s-e(this,R).length)),n>0&&(r=n%(s-e(this,R).length))}for(let t=e(this,R).length;t<s;t++)e(this,R).push(a);e(this,R)[e(this,R).length-1]+=r;let n=0;e(this,C).forEach(t=>{t.forEach((t,s)=>{let i=e(this,F).get(s)||{align:e(this,H)[s]||"l",width:e(this,R)[s]||-1,start:n,contentLength:0,lines:[]};n+=i.width,i.lines.push(t),t.length>i.contentLength&&(i.contentLength=t.length),e(this,F).set(s,i)})})}});const l="object"!=typeof s||Array.isArray(s)?{}:s;l.hasOwnProperty("rows")&&(s=l.rows),l.hasOwnProperty("align")&&(i=l.align),l.hasOwnProperty("maxWidths")&&(a=l.maxWidths),l.hasOwnProperty("tableWidth")&&(r=l.tableWidth),l.hasOwnProperty("margins")&&(n=l.margins),t(this,K,0===(a||[]).length),t(this,C,s||[]),t(this,H,i||[]),t(this,R,a||[]),t(this,I,(n||[0,0,0,0]).map(e=>e<0?0:e));for(let t=n.length;t<4;t++)e(this,I).push(0);t(this,q,(r||80)-(e(this,I)[0]+e(this,I)[1]))}get columns(){return!e(this,Q)&&e(this,X).call(this),e(this,F)}get columnCount(){return!e(this,Q)&&e(this,X).call(this),e(this,F).size}get rows(){return!e(this,Q)&&e(this,X).call(this),e(this,C)}get rowCount(){return!e(this,Q)&&e(this,X).call(this),e(this,C).length}set cellspacing(e){t(this,V,e<=0?0:e)}set fill(e){t(this,Z,e.substring(0,1))}get output(){e(this,Q)||e(this,X).call(this),e(this,V)>0&&e(this,F).forEach((t,s)=>{s<t.size-1&&(t.width=t.width-e(this,V))});let t=0;e(this,F).forEach((s,i)=>{let a=[];s.rows=[],s.lines.forEach(t=>{let r=s.width<0?s.contentLength:s.width;const n=e(this,N).indexOf(i)>=0?(h=r,(l=t).length<=h?[l]:[l.substring(0,h+1)]):this.wrap(t,r,s.align);var l,h;a=[...a,...n],s.rows.push(n.length)}),s.lines=a,t=a.length>t?a.length:t}),e(this,C).length>1&&e(this,F).forEach((t,s)=>{e(this,F).forEach((e,i)=>{if(s!==i){let s=0;t.rows.forEach(t=>{if(t>1)for(let i=1;i<t;i++)e.lines.splice(s+1,0,z(e.width));s+=t})}})});let s=[];const i=z(e(this,V)," ");let a=0;e(this,F).forEach((r,n)=>{r.lines.forEach((t,a)=>s[a]=(s[a]||"")+t+(n!==e(this,F).size-1?i:""));for(let e=r.lines.length;e<t;e++)s[e]=z(a+r.width," ");a+=r.width}),e(this,I).reduce((e,t)=>e+t,0)>0&&(s=s.map(t=>(e(this,I).forEach((e,s)=>{switch(s){case 0:t=`${z(e)}${t}`;break;case 1:t=`${t}${z(e)}`}}),t)));for(let t=0;t<e(this,I)[2];t++)s.unshift("");for(let t=0;t<e(this,I)[3];t++)s.push("");return s.join("\n")}wrap(t,s,i="right"){if(s<1)throw new Error("Width must be at least 1.");if(i="c"===(i=i.toLowerCase())?"center":"r"===i?"left":"right",t.length<=s)return[$(t.trim(),s,i,e(this,Z))];let a=e(this,G).get(s);a||(a=T(s),e(this,G).set(s,a));let r=t.match(a)||[],n=t.substring(r.join("").length);return n.length>s?r=r.concat(j(n,s,a)):n.length>0&&r.push(n),r.map(t=>$(t.trim(),s,i,e(this,Z)))}truncate(){0===arguments.length&&t(this,N,new Array(e(this,C).length).fill(0).map((e,t)=>t));for(let e of arguments)if(e<=0)return void t(this,N,[]);t(this,N,Array.from(new Set([...e(this,N),...arguments])))}}var ee=new WeakMap,te=new WeakMap,se=new WeakMap,ie=new WeakMap;class ae{constructor(e){ee.set(this,{writable:!0,value:null}),te.set(this,{writable:!0,value:80}),se.set(this,{writable:!0,value:[]}),ie.set(this,{writable:!0,value:["20%","15%","65%"]}),t(this,ee,e)}set width(e){t(this,te,e<20?20:e)}set columnWidths(e){t(this,ie,e)}set columnAlignment(e){t(this,se,e)}get usage(){const t=e(this,ee).description.trim();if(e(this,ee)instanceof Ne){const s=e(this,ee).aliases,i=[`${e(this,ee).commandroot}${s.length>0?"|"+s.join("|"):""}${e(this,ee).__flagConfig.size>0?" [FLAGS]":""}${e(this,ee).arguments.size>0?" "+Array.from(e(this,ee).arguments).map(e=>"<"+e+">").join(" "):""}`];return e(this,ee).__processors.size>0&&(i[i.length-1]+=(e(this,ee).arguments.size>0||e(this,ee).__flagConfig.size>0?" |":"")+" [COMMAND]"),t.trim().length>0&&i!==t&&i.push(new Y([[t.trim().replace(/\n/gi,"\n  ")]],null,null,e(this,te),[2,0,1,1]).output),i.join("\n")}return e(this,ee)instanceof Fe?`${e(this,ee).name}${e(this,ee).__processors.size>0?" [COMMAND]":""}\n${t.trim().length>0?new Y([[t.trim().replace(/\n/gi,"\n  ")]],null,null,e(this,te),[2,0,1,1]).output:""}${e(this,ee).arguments.size>0?" "+Array.from(e(this,ee).arguments).map(e=>"["+e+"]").join(" "):""}\n`.trim():""}get subcommands(){const t=Array.from(e(this,ee).__processors.values()).map(e=>[[e.name].concat(e.aliases).join("|"),e.description]);let s=[];if(t.length>0){const i=new Y(t,e(this,se),["25%","75%"],e(this,te),[2]);s.push("\nCommands:\n"),s.push(i.output)}return s.join("\n")}get help(){const t=this.usage.trim();if(e(this,ee)instanceof Ne){const s=e(this,ee).__flagConfig,i=[];s.size>0&&s.forEach((t,s)=>{let a=Array.from(t.aliases||t.alias||[]);a=0===a.length?"":"["+a.map(e=>"-"+e).join(", ")+"]";let r=[t.description||""];t.hasOwnProperty("options")&&e(this,ee).describeOptions&&r.push(`Options: ${t.options.join(", ")}.`),t.hasOwnProperty("allowMultipleValues")&&!0===t.allowMultipleValues&&e(this,ee).describeMultipleValues&&r.push("Can be used multiple times."),t.hasOwnProperty("default")&&e(this,ee).describeDefault&&r.push(`(Default: ${t.default.toString()})`),t.hasOwnProperty("required")&&!0===t.required&&e(this,ee).describeRequired&&r.unshift("Required."),r=r.join(" ").trim(),i.push(["--"+s,a||"",r||""])});const a=new Y(i,e(this,se),e(this,ie),e(this,te),[2,0,t.length>0?1:0,0]);let r="\n"+this.subcommands;return 0===r.trim().length&&(r=""),t+(s.size>0?"\n\nFlags:\n"+a.output:"")+r}return e(this,ee)instanceof Fe?[t,this.subcommands].join("\n"):""}}var re=new WeakMap,ne=new WeakMap,le=new WeakMap,he=new WeakMap,oe=new WeakMap,ue=new WeakMap,pe=new WeakMap,ce=new WeakMap,fe=new WeakMap,de=new WeakMap,ge=new WeakMap,me=new WeakMap,we=new WeakMap,ye=new WeakMap,be=new WeakMap,ve=new WeakMap,Oe=new WeakMap,Me=new WeakMap,Ae=new WeakMap;class Ee{constructor(s={}){if(re.set(this,{writable:!0,value:{}}),ne.set(this,{writable:!0,value:null}),le.set(this,{writable:!0,value:null}),he.set(this,{writable:!0,value:void 0}),oe.set(this,{writable:!0,value:void 0}),ue.set(this,{writable:!0,value:void 0}),pe.set(this,{writable:!0,value:void 0}),ce.set(this,{writable:!0,value:new Set}),fe.set(this,{writable:!0,value:!0}),de.set(this,{writable:!0,value:new Map}),ge.set(this,{writable:!0,value:new Map}),me.set(this,{writable:!0,value:80}),we.set(this,{writable:!0,value:"Unknown"}),ye.set(this,{writable:!0,value:new S}),be.set(this,{writable:!0,value:new S}),ve.set(this,{writable:!0,value:{}}),Oe.set(this,{writable:!0,value:{Default:null,Options:null,MultipleValues:null,Required:null}}),Me.set(this,{writable:!0,value:!1}),Ae.set(this,{writable:!0,value:function(t){return null!==this.parent&&this.parent.hasCustomDefaultHandler?this.parent.defaultHandler(...arguments):this.shell&&null!==this.shell&&this.shell.hasCustomDefaultHandler?this.shell.defaultHandler(...arguments):void(e(this,fe)&&console.log(this.help))}}),"object"!=typeof s)throw new Error("Invalid command configuration. Expected an object.");if(!s.hasOwnProperty("name"))throw new Error('Invalid command configuration. A "name" attribute is required.');if(s.hasOwnProperty("help")&&t(this,pe,s.help),s.hasOwnProperty("usage")&&t(this,ue,s.usage),s.hasOwnProperty("disablehelp")&&!s.hasOwnProperty("disableHelp")&&(s.disableHelp=s.disablehelp),s.hasOwnProperty("disableHelp")&&!0===s.disableHelp&&t(this,fe,!1),"function"!=typeof s.help&&"string"!=typeof s.help||(this.help=s.help),"function"!=typeof s.usage&&"string"!=typeof s.usage||(this.usage=s.usage),s.hasOwnProperty("defaultHandler")&&s.defaultHandler.toString()!==e(this,Ae).toString()&&(this.defaultHandler=s.defaultHandler),"string"==typeof s.arguments&&(s.arguments=s.arguments.split(/\s+|\t+|\,+|\;+/).map(e=>e.trim())),Array.isArray(s.arguments)&&t(this,ce,new Set(s.arguments)),"string"==typeof s.url&&t(this,ne,s.url),"string"==typeof s.support&&t(this,le,s.support),t(this,we,(s.name||"unknown").trim().split(/\s+/)[0]),t(this,oe,s.description||null),Array.isArray(s.commands))s.commands.forEach(e=>this.add(e));else if("object"==typeof s.commands)for(const e in s.commands){let t=s.commands[e];t.name=e,this.add(t)}if(s.hasOwnProperty("middleware")&&(console.warn('The "middleware" attribute has been replaced with the "use" attribute.'),s.use=s.middleware,delete s.middleware),s.hasOwnProperty("commonflag")||(s.hasOwnProperty("commonFlag")?s.commonflag=s.commonFlag:s.hasOwnProperty("commonflags")?s.commonflag=s.commonflags:s.hasOwnProperty("commonFlag")?s.commonflag=s.commonFlag:s.hasOwnProperty("commonFlags")&&(s.commonflag=s.commonFlags)),s.hasOwnProperty("commonflag")&&"object"!=typeof s.commonflag)throw new Error('The "commonflag" configuration attribute must be an object.');"object"==typeof s.plugins&&t(this,re,s.plugins),Object.defineProperties(this,{__processors:{enumerable:!1,get(){return e(this,de)}},__commands:{enumerable:!1,get(){return e(this,ge)}},__width:{enumerable:!1,get(){return e(this,me)},set(e){t(this,me,e||80)}},__commonflags:{enumerable:!1,get(){return e(this,ve)},set(e){t(this,ve,e)}},arguments:{enumerable:!1,get(){return e(this,ce)}},initializeMiddleware:{enumerable:!1,configurable:!1,writable:!1,value:e=>{if("string"==typeof e)this.use(Function("return "+e)());else{if("function"!=typeof e)throw new Error("Invalid middleware: "+e.toString());this.use(e)}}},initializeTrailer:{enumerable:!1,configurable:!1,writable:!1,value:e=>{if("string"==typeof e)this.trailer(Function("return "+e)());else{if("function"!=typeof e)throw new Error("Invalid trailer: "+e.toString());this.trailer(e)}}},initializeHelpAnnotations:{enumerable:!1,configurable:!1,writable:!1,value:t=>{t.hasOwnProperty("describeDefault")&&"boolean"==typeof t.describeDefault&&(e(this,Oe).Default=t.describeDefault),t.hasOwnProperty("describeOptions")&&"boolean"==typeof t.describeOptions&&(e(this,Oe).Options=t.describeOptions),t.hasOwnProperty("describeMultipleValues")&&"boolean"==typeof t.describeMultipleValues&&(e(this,Oe).MultipleValues=t.describeMultipleValues),t.hasOwnProperty("describeRequired")&&"boolean"==typeof t.describeRequired&&(e(this,Oe).Required=t.describeRequired)}}}),this.updateHelp()}get plugins(){return e(this,re)}get name(){return e(this,we)||"Unknown"}get description(){return e(this,oe)||this.usage||""}get url(){return this.URL}get URL(){let t=(e(this,ne)||"").trim();if(0===t.length){if(this.hasOwnProperty("parent"))return this.parent.URL;if(this instanceof Ne)return this.shell.URL}return t}get support(){let t=(e(this,le)||"").trim();if(0===t.length){if(this.hasOwnProperty("parent"))return this.parent.support;if(this instanceof Ne)return this.shell.support}return t}get autohelp(){return e(this,fe)}set autohelp(s){"boolean"==typeof s&&(t(this,fe,s),e(this,de).forEach(e=>e.autohelp=s))}updateHelp(){t(this,he,new ae(this)),e(this,he).width=e(this,me)}describeHelp(t,s){if(null!==e(this,Oe)[s])return e(this,Oe)[s];if(this instanceof Ne){if(this.shell&&null!==this.shell&&null!==this.shell[t])return this.shell[t];if(null!==this.parent)return this.parent[t]}return!0}get describeDefault(){return this.describeHelp("describeDefault","Default")}get describeOptions(){return this.describeHelp("describeOptions","Options")}get describeMultipleValues(){return this.describeHelp("describeMultipleValues","MultipleValues")}get describeRequired(){return this.describeHelp("describeRequired","Required")}get usage(){return null!==e(this,ue)?"function"==typeof e(this,ue)?e(this,ue).call(this):e(this,ue):e(this,he).usage}set usage(e){"string"==typeof e&&0===e.trim().length&&(e=null),t(this,ue,e),this.updateHelp()}get help(){return e(this,pe)?"function"==typeof e(this,pe)?e(this,pe).call(this,this):e(this,pe):this.autohelp?e(this,he).help:""}set help(e){"string"==typeof e&&0===e.trim().length&&(e=null),t(this,pe,e),this.updateHelp()}set defaultHandler(s){if("function"!=typeof s)throw new Error(`Invalid default method (must be a function, not "${typeof s}").`);t(this,Ae,s),t(this,Me,!0),e(this,de).forEach(e=>e.defaultProcessor=s)}get defaultHandler(){return e(this,Ae)}get hasCustomDefaultHandler(){return e(this,Me)}get data(){const t={};return Array.from(e(this,de).values()).forEach(e=>{let s=e.data;const i=s.name;delete s.name,t[i]=s}),t}get middleware(){return e(this,ye)}get trailers(){return e(this,be)}get commands(){return e(this,de)}get commandlist(){const e=new Set;return this.commands.forEach(t=>{e.add(t.name),t.commandlist.forEach(s=>e.add(`${t.name} ${s}`))}),Array.from(e).sort()}getCommand(t=null){if(!t)return null;let s=t.split(/\s+/i),i=e(this,ge).get(s.shift());if(i){i=e(this,de).get(i);for(const e of s)i=i.getCommand(e)}return i instanceof Ne?i:null}remove(){for(const t of arguments)if("symbol"==typeof t&&(e(this,de).delete(t),e(this,ge).forEach(s=>s===t&&e(this,ge).delete(s))),"string"==typeof t){const s=e(this,ge).get(t);s&&this.remove(s)}}use(){for(const t of arguments){if("function"!=typeof t)throw new Error(`All "use()" arguments must be valid functions.\n${t.toString().substring(0,50)} ${t.toString().length>50?"...":""}`);e(this,ye).use(t)}e(this,de).forEach(e=>e.use(...arguments))}trailer(){t(this,be,e(this,be)||new S);for(const t of arguments){if("function"!=typeof t)throw new Error(`All "trailer()" arguments must be valid functions.\n${t.toString().substring(0,50)} ${t.toString().length>50?"...":""}`);e(this,be).use(t)}e(this,de).forEach(e=>e.trailer(...arguments))}add(){for(let t of arguments){if(!(t instanceof Ne)){if("object"!=typeof t)throw new Error('Invalid argument. Only "Command" instances may be added to the processor.');t=new Ne(t)}t.autohelp=this.autohelp,this instanceof Fe?t.shell=this:this instanceof Ne&&(t.parent=this),e(this,de).set(t.OID,t),e(this,ge).set(t.name,t.OID),t.aliases.forEach(s=>e(this,ge).set(s,t.OID))}}}const ke=/((?:"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'|\/[^\/\\]*(?:\\[\S\s][^\/\\]*)*\/[gimy]*(?=\s|$)|(?:\\\s|\S))+)(?=\s|$)/g,We=/^([\w]+\s?)\(.*\)\s?{/i,Pe=/"([^"\\]*(\\.[^"\\]*)*)"|\'([^\'\\]*(\\.[^\'\\]*)*)\'/gi,_e=/^(\w+)\s+([\s\S]+)?/i;Object.freeze({SUBCOMMAND_PATTERN:/^([^"'][\S\b]+)[\s+]?([^-].*)$/i,FLAG_PATTERN:ke,METHOD_PATTERN:We,STRIP_QUOTE_PATTERN:Pe,COMMAND_PATTERN:_e});var Se=new WeakMap,je=new WeakMap,$e=new WeakMap,ze=new WeakMap,Te=new WeakMap,xe=new WeakMap,Ce=new WeakMap;class Fe extends Ee{constructor(e={maxhistory:100}){super(e),Se.set(this,{writable:!0,value:new Map}),je.set(this,{writable:!0,value:[]}),$e.set(this,{writable:!0,value:void 0}),ze.set(this,{writable:!0,value:void 0}),Te.set(this,{writable:!0,value:0}),xe.set(this,{writable:!0,value:void 0}),Ce.set(this,{writable:!0,value:globalThis.hasOwnProperty("window")?"browser":globalThis.hasOwnProperty("process")&&globalThis.process.release&&globalThis.process.release.name?globalThis.process.release.name:"unknown"}),this.initializeHelpAnnotations(e),this.__commonflags=e.commonflags||{},e.hasOwnProperty("use")&&Array.isArray(e.use)&&e.use.forEach(e=>this.initializeMiddleware(e)),e.hasOwnProperty("trailer")&&Array.isArray(e.trailer)&&e.trailer.forEach(e=>this.initializeTrailer(e)),t(this,ze,e.version||"1.0.0"),t(this,$e,e.maxhistory||e.maxHistoryItems||100),t(this,xe,e.hasOwnProperty("tabWidth")?e.tabWidth:4),globalThis[Symbol("SHELL_INTEGRATIONS")]=this}get data(){const t=super.data;return{name:this.name,description:this.description,version:this.version,commands:t,use:this.middleware.data,trailer:this.trailers.data,help:this.help,usage:this.usage,defaultHandler:this.defaultHandler.toString(),disableHelp:!this.autohelp,runtime:e(this,Ce),maxHistoryItems:e(this,$e)}}get version(){return e(this,ze)||"Unknown"}set tableWidth(e){this.__width=e}get tableWidth(){return this.__width}history(t=null){return 0===e(this,je).length?[]:null===t?e(this,je).slice():e(this,je).slice(0,t)}priorCommand(s=0){return 0===e(this,je).length?null:s<0?this.nextCommand(abs(s)):(s%=e(this,je).length,t(this,Te,e(this,Te)+s),e(this,Te)>=e(this,je).length&&t(this,Te,e(this,je).length-1),e(this,je)[e(this,Te)].input)}nextCommand(s=1){return 0===e(this,je).length?null:s<0?this.priorCommand(abs(s)):(s%=e(this,je).length,t(this,Te,e(this,Te)-s),e(this,Te)<0?void t(this,Te,0):e(this,je)[e(this,Te)].input)}useWith(t){if(arguments.length<2)throw new Error("useWith(['command', 'command'], fn) requires two or more arguments.");if(t="string"==typeof t?t.split(/\s+/):t,!Array.isArray(t)||t.filter(e=>"string"!=typeof e).length>0)throw new Error("The first argument of useWith must be a string or array of strings. Received "+typeof t);const s=Array.from(arguments).slice(1);t.forEach(t=>e(this,Se).set(t.trim(),(e(this,Se).get(t.trim())||[]).concat(s)))}useExcept(e){if(arguments.length<2)throw new Error("useExcept(['command', 'command'], fn) requires two or more arguments.");if(e="string"==typeof e?e.split(/\s+/):e,!Array.isArray(e)||e.filter(e=>"string"!=typeof e).length>0)throw new Error("The first argument of useExcept must be a string or array of strings. Received "+typeof e);const t=Array.from(arguments).slice(1),s=new Set(this.commandlist.map(e=>e.toLowerCase()));e.forEach(e=>{s.delete(e);for(const t of s)0===t.indexOf(e)&&s.delete(t)}),this.useWith(Array.from(s),...t)}async exec(t,s){Array.isArray(t)&&(t=t.join(" ")),e(this,je).unshift({input:t,time:(new Date).toLocaleString()}),e(this,je).length>e(this,$e)&&e(this,je).pop();let i=_e.exec(t+" ");if(null===i)return-1!==t.indexOf("version")||-1!==t.indexOf("-v")?console.log(this.version):-1!==t.indexOf("help")?console.log(this.help):Ne.stderr(this.help);i=i.filter(e=>void 0!==e);let a=i[1],r=i.length>2?i[2]:"";const n=this.__commands.get(a);if(!n)return"version"===a.toLowerCase()?console.log(this.version):Ne.stderr(this.help);let l=this.__processors.get(n);if(!l)return Ne.stderr("Command not found.");const h=l.getTerminalCommand(r);return await Ne.reply(await h.command.run(h.arguments,s))}getCommandMiddleware(t){let s=[];return t.split(/\s+/).forEach((t,i,a)=>{let r=e(this,Se).get(a.slice(0,i+1).join(" "));r&&s.push(r.flat(1/0))}),s.flat(1/0)}clearHistory(){t(this,je,[])}clear(){t(this,je,[]),console.clear()}}var He=new WeakMap,Re=new WeakMap,qe=new WeakMap,De=new WeakMap,Le=new WeakMap,Ve=new WeakMap,Ie=new WeakMap;class Ne extends Ee{constructor(s={}){if(s.hasOwnProperty("handler")&&("string"==typeof s.handler&&(s.handler=Function("return ("+s.handler.replace("function anonymous","function")+").call(this)").call(globalThis)),"function"!=typeof s.handler))throw new Error('Invalid command configuration. A "handler" function is required.');if(super(s),He.set(this,{writable:!0,value:void 0}),Re.set(this,{writable:!0,value:void 0}),qe.set(this,{writable:!0,value:new Set}),De.set(this,{writable:!0,value:void 0}),Le.set(this,{writable:!0,value:{}}),Ve.set(this,{writable:!0,value:null}),Ie.set(this,{writable:!0,value:null}),s.hasOwnProperty("use")&&Array.isArray(s.use)&&s.use.forEach(e=>this.initializeMiddleware(e)),s.hasOwnProperty("trailer")&&Array.isArray(s.trailer)&&s.trailer.forEach(e=>this.initializeTrailer(e)),this.initializeHelpAnnotations(s),t(this,De,s.handler),t(this,Re,Symbol(s.name||s.usage||s.pattern||"command")),t(this,He,s.pattern||/[\s\S]+/i),s.alias&&!s.aliases&&(s.aliases="string"==typeof s.alias?[s.alias]:Array.isArray(s.alias)?s.alias:Array.from(s.alias),delete s.alias),s.aliases){if(!Array.isArray(s.aliases))throw new Error("The alias property only accepts an array.");t(this,qe,new Set(s.aliases))}if(s.flags){if("object"!=typeof s.flags)throw new Error(`Invalid flag configuration (expected and object, received ${typeof s.flags}).`);for(const[e,t]of Object.entries(s.flags))if(t.hasOwnProperty("alias")){if(t.aliases=t.aliases||[],Array.isArray(t.alias)){if(t.aliases=Array.from(new Set(...t.aliases,...t.alias)),t.aliases.filter(e=>"string"!=typeof e)>0)throw new Error(`${e} flag aliases must be strings. Type failure on: ${t.aliases.filter(e=>"string"!=typeof e).join(", ")}.`)}else{if("string"!=typeof t.alias)throw new Error(`Aliases must be strings, not ${typeof t.alias} (${e} flag).`);t.aliases.push(t.alias)}delete t.alias}t(this,Le,s.flags)}Array.isArray(s.subcommands)&&this.add(...s.subcommands);const i=new Set(["commands","subcommands","plugins","defaultHandler","disableHelp","describeDefault","describeOptions","describeMultipleValues","describeRequired","flags","alias","aliases","description","help","usage","pattern","name","handler","middleware","use","arguments","commonflag","commonflags","trailer","url","support"]),a=Object.keys(s).filter(e=>!i.has(e));if(a.length>0)throw new Error("Unrecognized configuration attribute(s): "+a.join(", "));const r=e=>{if(e.ignore&&(Array.isArray(e.ignore)||"string"==typeof e.ignore)){const t=new Set(Array.isArray(e.ignore)?e.ignore:[e.ignore]),s=this.commandroot.replace(new RegExp(`^${this.shell.name}\\s+`,"i"),"");for(const i of t)if(s.startsWith(i)){e={};break}}return e};Object.defineProperties(this,{__commonFlags:{enumerable:!1,get(){let e=r(this.__commonflags);null!==this.parent&&(e=Object.assign(e,this.parent.__commonFlags));const t=Object.assign({},null!==this.shell?r(this.shell.__commonflags):{},e);return(Array.isArray(t.ignore)||"string"==typeof t.ignore)&&delete t.ignore,t}},__flagConfig:{enumerable:!1,get(){let t=new Map(Object.entries(Object.assign(this.__commonFlags,e(this,Le)||{})));return t.delete("help"),t}},getTerminalCommand:{enumerable:!1,configurable:!1,writable:!1,value:e=>{let t=e.trim().split(/\t+|\s+/),s=this;for(;t.length>0;){const e=t[0],i=s.getCommand(e);if(!i)break;s=i,t.shift()}return{command:s,arguments:t.join(" ")}}}}),this.__commonflags=s.commonflags||{},this.__width=null===this.shell?80:this.shell.tableWidth||80,this.updateHelp()}get data(){const t=super.data;let s=(e(this,De)||this.defaultHandler).toString();We.test(s)&&(s=s.replace(We.exec(s)[1],"function "));let i=Object.assign(this.__commonFlags,e(this,Le)||{});for(let[e,t]of Object.entries(i))t.aliases=t.aliases||[],t.hasOwnProperty("alias")&&t.aliases.indexOf(t.alias)<0&&t.aliases.push(t.alias),delete t.alias;Object.keys(i).forEach(e=>i[e]=Object.assign(this.getFlagConfiguration(e),i[e]));const a={name:this.name,description:this.description,help:this.help,usage:this.usage,aliases:Array.from(e(this,qe)),flags:i,handler:s,commands:t,disableHelp:!this.autohelp,use:this.middleware.data,trailer:this.trailers.data};for(let[e,t]of Object.entries(a.flags))delete t.alias;return a}set parent(e){if(!(e instanceof Ne))throw new Error(`Cannot set parent of "${this.name}" command to anything other than another command. To make this command a direct descendent of the main shell, use the shell attribute instead.`);t(this,Ve,e)}get parent(){return e(this,Ve)}set shell(e){if(!e)throw new Error(`Cannot set shell of ${this.name} command to a non-Shell object.`);if(!(e instanceof Fe))throw new Error(`Expected a Shell object, received a "${typeof e}" object.`);t(this,Ie,e),this.__width=null===this.shell?80:e.tableWidth}get shell(){return e(this,Ie)?e(this,Ie):e(this,Ve)?e(this,Ve).shell:null}get plugins(){return Object.assign({},this.shell.plugins,this.parent?this.parent.plugins:{},super.plugins)}get commandroot(){return e(this,Ve)?`${e(this,Ve).commandroot} ${this.name}`.trim():e(this,Ie)?`${e(this,Ie).name} ${this.name}`.trim():this.name}set aliases(e){if(e){if("object"==typeof e)switch(e.constructor.name.toLowerCase()){case"map":e=Array.from(e.keys());break;case"set":e=Array.from(e);break;case"object":e=Object.keys(e).filter(e=>"string"==typeof e);break;case"array":break;case"string":e=e.split(/\s+/)[0];break;default:throw new Error("Invalid alias value. Use an array of strings.")}t(this,qe,Array.from(new Set(e)))}else t(this,qe,[])}get aliases(){return Array.from(e(this,qe))||[]}get OID(){return e(this,Re)}addFlag(t,s){if("string"!=typeof t){if(!s.hasOwnProperty("name"))throw new Error("Invalid flag name (should be a string).");t=s.name}e(this,Le)[t]=s}removeFlag(t){delete e(this,Le)[t]}getFlagConfiguration(e){let t=this.__flagConfig.get(e);if(!t){for(let[s,i]of this.__flagConfig)if(i.aliases&&i.aliases.indexOf(e)>=0||i.alias&&i.alias===t){t=i;break}if(!t)return null}return{description:t.description,required:!!t.hasOwnProperty("required")&&t.required,aliases:t.aliases||[t.alias].filter(e=>null!==e),type:void 0===t.type?"string":"string"==typeof t.type?t.type:t.type.name.toLowerCase(),options:t.hasOwnProperty("options")?t.options:null,allowMultipleValues:!!t.hasOwnProperty("allowMultipleValues")&&t.allowMultipleValues}}supportsFlag(t){return e(this,Le).hasOwnProperty(t)}deepParse(e){let t=this.parse(e);if(0===this.__commands.size)return t;if(0===t.input.trim().length)return t;let s=t.input.split(/\s+/),i=this.__commands.get(s.shift());return i?this.__processors.get(i).deepParse(s.join(" ")):t}parse(t){const s={command:this.name,input:t.trim()};let i=Object.assign(this.__commonFlags,e(this,Le)||{});i.hasOwnProperty("help")||(i.help={description:`Display ${this.name} help.`,default:!1,type:"boolean"});const a=Array.from(ke[Symbol.matchAll](t),e=>e[0]),r=new _(a,i),n=r.data,l={};if(r.recognizedFlags.forEach(e=>l[e]=n[e]),r.unrecognizedFlags.forEach(e=>delete l[e]),s.flags={recognized:l,unrecognized:r.unrecognizedFlags},s.valid=r.valid,s.violations=r.violations,s.parsed={},Object.keys(n.flagSource).length>0)for(const[e,t]of Object.entries(n.flagSource))s.parsed[t.name]=t.inputName;s.help={requested:l.help},l.help&&(s.help.message=this.help);const h=Array.from(this.arguments);return Object.defineProperties(s,{flag:{enumerable:!0,configurable:!1,writable:!1,value:e=>{try{return"number"==typeof e?Array.from(r.unrecognizedFlags)[e]:s.flags.recognized.hasOwnProperty(n.flagSource[e].name)?s.flags.recognized[n.flagSource[e].name]:n.flagSource[e].value}catch(t){return this.arguments.has(e)?Array.from(r.unrecognizedFlags)[h.indexOf(e)]:void 0}}},command:{enumerable:!0,get:()=>this},shell:{enumerable:!0,get:()=>this.shell},data:{enumerable:!0,get(){let e=r.unrecognizedFlags,t=Object.assign({},l);return delete t.help,h.forEach((s,i)=>{let a=e[i],r=Object.keys(n).filter(e=>e.toLowerCase()===a);r=r.length>0?r.pop():a,void 0!==r&&(r=r.trim(),Pe.test(r)&&(r=r.substring(1,r.length-1))),t.hasOwnProperty(s)?(t[s]=Array.isArray(t[s])?t[s]:[t[s]],t[s].push(r)):t[s]=r}),e.length>h.length&&e.slice(h.length).forEach((e,s)=>{let i="unknown"+(s+1);for(;t.hasOwnProperty(i);){let e=i.substring(7);i="unknown"+(parseInt(e)+1)}t[i]=e}),t}}}),Object.defineProperty(s.help,"default",{enumerable:!0,get:()=>this.help}),s}async run(t,s){let i=(e(this,De)||this.defaultHandler).bind(this);const a="string"==typeof t?this.parse(t):t;if(arguments[0]=this.deepParse(t),arguments[0].plugins=this.plugins,null!==this.shell){const e=this.shell.getCommandMiddleware(this.commandroot.replace(new RegExp("^"+this.shell.name,"i"),"").trim());e.length>0&&this.middleware.use(...e)}let r=this.trailers;return arguments[0].help&&arguments[0].help.requested?(console.log(this.help),void(r.size>0&&r.run(arguments[0]))):this.middleware.size>0?(this.middleware.run(arguments[0],async e=>await Ne.reply(i(e,s))),void(r.size>0&&r.run(arguments[0]))):(a.plugins=this.plugins,Ne.reply(i(a,s)),void(r.size>0&&r.run(arguments[0])))}static stderr(e){return Error,new Promise((t,s)=>s(e))}static reply(e){return new Promise((t,s)=>{try{"function"==typeof e&&e(),t()}catch(e){s(e)}})}}const Ue={Shell:Fe,Command:Ne,Formatter:ae,Table:Y,Middleware:S};export default Ue;export{Ne as Command,ae as Formatter,S as Middleware,Fe as Shell,Y as Table};
//# sourceMappingURL=../node-shell-debug/shell-1.8.2.min.js.map
